<?xml version="1.0" encoding="utf-8" ?>
<Settings>
  <General>
    <Log>
      <!-- 
        If the logs are going to be stored outside of the applicaiton directory:
          1. Set LocalLocation to True
          2. Use an absolute path in the Location
        Otherwise logs will be stored in the APP_ROOT\logs\ directory.
        -->
      <LocalLocation>True</LocalLocation>
      
      <!-- Location to save the log files, will date prepend on the final . -->
      <Location>mail_agent.log</Location>
      
      <!--
        Defines the level of logging to output to the logs.
          1. NONE
          2. CRITICAL
          3. ERROR
          4. WARNING
          5. INFO
          6. DEBUG
        -->
      <Level>DEBUG</Level>
    </Log>
    <Mail>
      <!-- The rate to check the account (in seconds) -->
      <Polling>900</Polling>
      
      <!--
        The version of Exchange that EWS is using. Default: 2010
          - 2007 SP1
          - 2010
          - 2010 SP1
          - 2010 SP2
          - 2013
          - 2013 SP1
        -->
      <ExchangeVersion>2010</ExchangeVersion>
      <UseWindowsCredentials>False</UseWindowsCredentials>
      
      <!-- Email address to check -->
      <Email>inma@cmich.edu</Email>
      
      <!-- Not required if using Windows Credentials -->
      <Password>GC9zL6LuBDsTQCfXmrdV</Password>
      
      <!-- The Exchange folder where mail items go when there is an error or no profile associated to the email -->
      <ErrorFolder>Errors</ErrorFolder>

      <!-- The Exchange folder where mail items go when they have been fully processed -->
      <SuccessFolder>Success</SuccessFolder>
      
      <!-- Use Auto if you are using Autodiscover -->
      <Url>Auto</Url>
    </Mail>
    <!-- The default path to save email files. Requires a trailing \ -->
    <DefaultSavePath>\\imageapp-test\d$\inserver6\temp\import\MailAgentImport\</DefaultSavePath>

    <Export>
      <!-- The name of the indexing file -->
      <Filename>export.hdf</Filename>
      
      <!-- The delimiter to seperate fields for the document -->
      <KeyDelimiter>^</KeyDelimiter>
    </Export>
  </General>
  <Profiles>
    <Profile>
      <!-- The name of the profile -->
      <Name>Profile 1</Name>
      <Active>True</Active>
      
      <!-- The subject substring to match -->
      <!-- Recommended: Use API:<<sha of profile name>> to ensure unique values -->
      <EmailSubject></EmailSubject>
      
      <!-- The body substring to match -->
      <!-- Use the attribute Save="True" to save the body of the email to the output directory of the profile -->
      <EmailBody Save="True">Document</EmailBody>
      
      <!-- Boolean for save attachments -->
      <SaveAttachments>False</SaveAttachments>

      <!-- The save path is an optional global override -->
      <!-- <SavePath></SavePath> -->

      <!-- The delimiter is an optional global override -->
      <!-- <KeyDelimiter></KeyDelimiter> -->
      
      <!--
        Keys (from top to bottom in order) to use in the index file.
          Set Type to Manual for static text that goes in the key.
          Set Type to Search to search for text in the email body
          Set Type to Dynamic to set one of the 'dynamic' fields:
            - DATETIME
            - DATE
            - TIME
            - INCREMENT
            - NULL
        -->
      <Keys>
        <Drawer Type="Static">OIT-TC-View</Drawer>
        <Field1 Type="Static">Abc</Field1>
        <Field2 Type="Static">Def</Field2>
        <Field3 Type="Static">Ghi</Field3>
        <Field4 Type="Dynamic">NULL</Field4>
        <Field5 Type="Dynamic">DATETIME</Field5>
        <DocType Type="Static">OIT-TC-A Document Type</DocType>
      </Keys>
    </Profile>
    <Profile>
      <Name>Profile 2</Name>
      <Active>True</Active>
      <EmailSubject>INMA:</EmailSubject>
      <EmailBody Save="True"></EmailBody>
      <SaveAttachments>True</SaveAttachments>
      <!--<SavePath>\\imageapp-res\miu2n-download\</SavePath>-->
      <Keys>
        <Drawer Type="Static">OIT-TC-View</Drawer>
        <Field1 Type="Static">aaa</Field1>
        <Field2 Type="Static">bbb</Field2>
        <Field3 Type="Dynamic">NULL</Field3>
        <Field4 Type="Dynamic">NULL</Field4>
        <Field5 Type="Dynamic">DATE</Field5>
        <DocType Type="Static">SomethingCool</DocType>
      </Keys>
    </Profile>
  </Profiles>
</Settings>
